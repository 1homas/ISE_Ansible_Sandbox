---
#
# Show cisco.ise.network_access_dictionary_attributes_policy_set Template
#

- name: Get network_access_dictionary_attributes_policy_set
  cisco.ise.network_access_dictionary_attributes_policy_set_info:
    ise_hostname: "{{ ansible_host }}"
    ise_username: "{{ ise_username | default( omit ) }}"
    ise_password: "{{ ise_password | default( omit ) }}"
  register: info

- name: Set `network_access_dictionary_attributes_policy_sets`
  ansible.builtin.set_fact:
    network_access_dictionary_attributes_policy_sets: "{{ info.ise_response }}"

- name: Tablize results
  when: info is defined
    and info.ise_response | count > 0
  delegate_to: localhost
  vars:
    hide: ["id", "allowedValues"]
    maxw: 30
    rows: "{{ network_access_dictionary_attributes_policy_sets }}"
    temp: "{{ lookup('template', 'templates/list_of_dicts.j2') }}"
  ansible.builtin.debug:
    msg: "{{ temp }}"

- name: To YAML
  when: resources is defined
    and resources | count > 0
  delegate_to: localhost
  changed_when: false
  ansible.builtin.shell: "echo '\n\n{{ resources | to_nice_yaml(indent=2) }}'> /dev/tty"

- name: To YAML File | {{ dir_ise_configs }}/{{ resource_name }}.yaml
  when: resources is defined
    and resources | count > 0
  delegate_to: localhost
  vars:
    resource_name: network_access_dictionary_attributes_policy_sets
    resources: "{{ network_access_dictionary_attributes_policy_sets }}"
  ansible.builtin.template:
    src: templates/resource_template.j2
    dest: "{{ dir_ise_configs }}/{{ resource_name }}.yaml"
    mode: "0644"
